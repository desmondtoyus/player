<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>
<style>
  #console {
    background-color: yellow;
}
#element1 {
			width: 500px;
			height: 100px;
			background-color: lightblue;
			overflow-y: scroll;
			padding-top: 150px;
			margin: 45px;
		}
		
		#pid-105 {
			margin-top: 110px;
      margin-bottom: 400px;
			width: 400px;
			height: 320px;
			background-color: green;
            /* visibility: hidden; */
		}
</style>
<body>
    <br/><br/>
<div id="console"></div>
<div id="element1">
    <div id="pid-105"></div>
</div>
    <br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/>
    <br/>
    <br/>
    <br/>
    <br/>
    <br/>
    <br/>
    <br/>
    <br/>
    <br/>
    <br/>
    <br/>
    <br/>
    <br/>
    <br/>
    <br/>
    <br/>
    <br/>
    <br/>
    <br/>
    <br/>
    <br/>
    <br/>
    <br/>
    <br/>
    <br/>
    <br/>
    <br/>
    <br/>
    <br/>
    <br/>
</body>
<script>
    // let newDiv = document.getElementById('nue');
    // setInterval(() => {
    //       console.log(isInViewport(newDiv));
    // }, 1000);
  
    // function isElementInViewport(el) {
    //         var rect = el.getBoundingClientRect();
    //         return (
    //             rect.top >= 0 &&
    //             rect.left >= 0 &&
    //             rect.bottom <= (window.innerHeight || document.documentElement.clientHeight) &&
    //             rect.right <= (window.innerWidth || document.documentElement.clientWidth)
    //         );
    //     }



    


    function visibleY  (el) {
            var rect = el.getBoundingClientRect(), top = rect.top, height = rect.height,
                el = el.parentNode;
            do {
                rect = el.getBoundingClientRect();
                if (top <= rect.bottom === false) return false;
                // Check if the element is out of view due to a container scrolling
                if ((top + height) <= rect.top) return false
                el = el.parentNode;
            } while (el != document.body);
            // Check its within the document viewport
            return top <= document.documentElement.clientHeight;
        };

        // Stuff only for the demo
        function attachEvent(element, event, callbackFunction) {
            if (element.addEventListener) {
                element.addEventListener(event, callbackFunction, false);
            } else if (element.attachEvent) {
                element.attachEvent('on' + event, callbackFunction);
            }
        };

        function update () {
            // document.getElementById('console').innerHTML = visibleY(document.getElementById('element2'))
            //     ? "Inner element is visible" : "Inner element is not visible";
        console.log(visibleY(document.getElementById('pid-105')));
        };
       
        // attachEvent(window, "resize", update);
        // update();


    function isItScrollableWithoutVisibleScrollbars (el) {
                return (!(el && (el.scrollHeight > el.offsetHeight) && !(el.offsetWidth > el.scrollWidth)));
            };


function parents(element, _array) {
    if (_array === undefined) _array = []; // initial call
    else _array.push(element); // add current element
    // do recursion until BODY is reached
    if (element.tagName !== 'BODY' ) return parents(element.parentNode, _array);
    else{ 
       
        if (_array.length >= 2) {
            let myParent = _array[_array.length - 2].id;
            console.log('PARENT NAME=', myParent )
             if (isItScrollableWithoutVisibleScrollbars(document.getElementById(myParent))) {
                 console.log('has scroll');
                  attachEvent(document.getElementById(myParent), "scroll", update);
             } else {
                 console.log('has no scroll');
             }
        } else {
            return 'NOT IN A DIV';
        }
        
    }
}

var parentsArray = parents(document.getElementById('pid-105'));
// console.log('PARENTS=', parentsArray, isItScrollableWithoutVisibleScrollbars(document.getElementById("element1")));
</script>



</html>